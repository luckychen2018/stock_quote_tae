# 股票行情监控系统

一个功能完整的A股股票行情监控系统，支持实时数据获取、Web界面展示、自动数据更新和开机自启功能。

## 📋 功能特点

### 核心功能
- **实时股票数据**：获取上海、深圳和北京证券交易所股票的最新行情
- **完整市场信息**：显示股票代码、名称、市场、当前价格、涨跌幅、涨跌额等
- **详细交易数据**：开盘价、收盘价、最高价、最低价、成交量、成交额
- **买卖五档**：显示完整的买卖盘口数据
- **数据可视化**：实时价格走势图和全天价格走势图
- **关注列表**：支持添加股票到关注列表，方便集中管理

### 系统特性
- **自动数据刷新**：可开启/关闭自动刷新功能
- **后台服务**：每10秒自动获取关注列表中股票的数据
- **交易时间限制**：后台服务只在交易时间内（9:30-11:30, 13:00-15:00）获取数据
- **开机自启**：支持Windows系统开机自动启动
- **单实例运行**：确保后台服务只有一个实例在运行
- **非交易时间数据**：非交易时间显示数据库中的最新历史数据

## 🛠️ 技术架构

### 后端技术
- **Python 3.6+**：核心编程语言
- **Flask**：Web框架，提供API接口
- **SQLAlchemy**：ORM框架，操作SQLite数据库
- **Requests**：HTTP客户端，获取股票数据

### 前端技术
- **HTML5/CSS3**：页面结构和样式
- **JavaScript**：交互逻辑
- **Chart.js**：数据可视化，绘制价格走势图

### 数据存储
- **SQLite**：轻量级数据库，存储股票数据和关注列表

## 📦 环境要求

- Python 3.6 或更高版本
- 网络连接
- Windows操作系统（开机自启功能）

## 🔧 安装步骤

1. **克隆或下载项目**到本地

2. **安装依赖库**：
   ```bash
   pip install -r requirements.txt
   ```

3. **启动系统**：
   - **方法1（手动启动）**：双击 `start_stock_monitor.bat`
   - **方法2（开机自启）**：将 `start_stock_monitor.vbs` 复制到 Windows 启动文件夹
     - 启动文件夹路径：`C:\Users\用户名\AppData\Roaming\Microsoft\Windows\Start Menu\Programs\Startup`

## 🚀 使用方法

### 基本操作
1. **访问系统**：浏览器自动打开 `http://localhost:5000/`
2. **输入股票代码**：在输入框中输入股票代码，点击「获取数据」
3. **添加到关注**：点击「添加到关注」按钮将股票添加到关注列表
4. **自动刷新**：使用开关控制是否开启自动刷新功能

### 关注列表
- **查看关注股票**：在关注列表中查看已添加的股票
- **快速查看**：点击关注列表中股票的「查看」按钮快速查看数据
- **删除股票**：点击「删除」按钮从关注列表中移除股票

### 数据展示
- **股票信息**：显示股票的基本信息和交易数据
- **价格走势图**：显示最近的价格变化趋势
- **全天走势图**：显示当天的价格变化曲线
- **买卖五档**：显示完整的买卖盘口数据

## 📊 数据来源

系统使用新浪财经API获取股票数据：
```
http://hq.sinajs.cn/rn=时间戳&list=股票代码
```

**数据更新频率**：
- 手动获取：实时更新
- 自动刷新：每5秒更新一次
- 后台服务：每10秒更新一次（仅交易时间）

## ⏰ 交易时间

系统遵循A股交易时间：
- **周一至周五**
  - 上午：9:30 - 11:30
  - 下午：13:00 - 15:00
- **非交易时间**：显示数据库中的最新历史数据

## 📁 项目结构

```
stock_quote_tae/
├── templates/              # 前端页面
│   └── index.html          # 主页面
├── app.py                  # Flask应用（API接口和Web服务）
├── background_service.py   # 后台服务（自动数据获取）
├── get_stock_quote.py      # 股票数据获取模块
├── requirements.txt        # 项目依赖
├── start_stock_monitor.bat # 批处理启动脚本
├── start_stock_monitor.vbs # VBScript启动脚本（开机自启）
└── stock_data.db           # SQLite数据库文件
```

## 🔍 核心文件说明

### `app.py`
- 主应用程序，提供Web界面和API接口
- 处理股票数据请求、关注列表管理
- 非交易时间返回历史数据

### `background_service.py`
- 后台自动数据获取服务
- 每10秒检查一次交易时间
- 交易时间内自动获取关注列表中股票的数据
- 支持单实例运行

### `get_stock_quote.py`
- 股票数据获取模块
- 从新浪财经API获取原始数据
- 解析和处理数据
- 支持上海、深圳、北京市场

### `start_stock_monitor.vbs`
- Windows开机自启脚本
- 清理旧的后台服务进程
- 启动Flask应用和后台服务
- 自动打开浏览器访问系统

## 🚩 注意事项

1. **网络连接**：确保网络连接正常，否则无法获取实时数据
2. **API稳定性**：系统依赖新浪财经API，若API变更可能影响数据获取
3. **数据延迟**：数据更新可能存在轻微延迟，取决于网络状况
4. **非交易时间**：非交易时间显示的是历史数据，不是实时数据
5. **权限设置**：开机自启功能需要适当的系统权限

## 🔧 常见问题

### Q: 为什么数据显示为历史数据？
**A:** 可能是因为当前不在交易时间内，系统会显示数据库中的最新历史数据。

### Q: 开机自启不工作怎么办？
**A:** 检查启动文件夹路径是否正确，确保脚本有执行权限，尝试手动运行脚本测试。

### Q: 如何修改自动刷新间隔？
**A:** 在前端页面使用开关控制自动刷新，后台服务的刷新间隔可修改 `background_service.py` 中的 `FETCH_INTERVAL` 变量。

### Q: 关注列表数据存储在哪里？
**A:** 关注列表数据存储在 `stock_data.db` SQLite数据库中。

## 📄 许可证

本项目仅供学习和研究使用，请勿用于商业用途。

## 🤝 贡献

欢迎提交Issue和Pull Request，帮助改进这个项目！

---

**享受您的股票监控之旅！** 📈